<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DATA LIGUE 1 – Formulaire</title>

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
  <meta name="theme-color" content="#0c67f6" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7EXC0P38K5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-7EXC0P38K5');
  </script>

  <!-- Brevo assets -->
  <style>
    @font-face{font-display:block;font-family:Roboto;src:url(https://assets.brevo.com/font/Roboto/Latin/normal/normal/7529907e9eaf8ebb5220c5f9850e3811.woff2) format("woff2"), url(https://assets.brevo.com/font/Roboto/Latin/normal/normal/25c678feafdc175a70922a116c9be3e7.woff) format("woff")}
    @font-face{font-display:fallback;font-family:Roboto;font-weight:600;src:url(https://assets.brevo.com/font/Roboto/Latin/medium/normal/6e9caeeafb1f3491be3e32744bc30440.woff2) format("woff2"), url(https://assets.brevo.com/font/Roboto/Latin/medium/normal/71501f0d8d5aa95960f6475d5487d4c2.woff) format("woff")}
    @font-face{font-display:fallback;font-family:Roboto;font-weight:700;src:url(https://assets.brevo.com/font/Roboto/Latin/bold/normal/3ef7cf158f310cf752d5ad08cd0e7e60.woff2) format("woff2"), url(https://assets.brevo.com/font/Roboto/Latin/bold/normal/ece3a1d82f18b60bcce0211725c476aa.woff) format("woff")}
    #sib-container input::placeholder, #sib-container textarea::placeholder {text-align:left;font-family:Helvetica,sans-serif;color:#c0ccda}
    #sib-container a{text-decoration:underline;color:#2BB2FC}
  </style>
  <!-- Suppression du CSS externe qui cause les erreurs CORS -->
  <!-- <link rel="stylesheet" href="https://sibforms.com/forms/end-form/build/sib-styles.css"> -->

  <!-- Styles -->
  <style>
    :root{ --blue:#0c67f6; --ink:#3C4858; }
    html,body{ margin:0; padding:0; background:var(--blue); font-family:Helvetica,Arial,sans-serif }
    .wrap{ max-width:620px; margin:0px auto 24px; padding:0 10px }
    .sib-form{ background-color:#c8dbf6 !important; }
    .sib-form .entry__label{ color:var(--ink) !important; }
    .sib-form .entry__choice span{ color:var(--ink) !important; font-size:18px !important; }
    .sib-form .sib-form-block p{ color:#3C4858 !important; margin:0; }
    .sib-form-block__button{ width:100%; padding:.85rem 1rem }

    /* Voir plus */
    .see-more-btn{
      margin:6px 0 2px;
      background:#eef4ff;
      border:1px solid #c7d6ff;
      color:#0c67f6;
      font-weight:600;
      border-radius:6px;
      padding:.5rem .75rem;
      cursor:pointer;
      width:100%;
      text-align:center;
    }
    .see-more-btn:focus{ outline:2px solid #0c67f6; outline-offset:2px }
    #more-clubs[hidden]{ display:none!important; }

    /* Honeypot Brevo */
    .input--hidden { position: absolute; left: -5000px; }

    /* Anti-overlay agressif pour garantir le clic */
    .sib-form-container, #sib-container, .sib-form-block { position: relative; }
    #error-message, #success-message { position: static !important; }
    .sib-form-block__button,
    .sib-form-block__button.sib-form-block__button-with-loader {
      position: relative;
      z-index: 9999;
      pointer-events: auto !important;
    }
    .sib-form-block__button-with-loader::before,
    .sib-form-block__button-with-loader::after {
      content: none !important;
      display: none !important;
      pointer-events: none !important;
    }

    /* iFrame caché */
    #sibframe{ width:0;height:0;border:0; position:absolute; left:-9999px; }
    
    /* Styles des checkboxes */
    .entry__choice { margin: 8px 0; text-align: left; }
    .checkbox__label { display: flex; align-items: center; cursor: pointer; }
    .checkbox { 
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid #c0ccda;
      border-radius: 3px;
      margin-right: 10px;
      flex-shrink: 0;
    }
    .input_replaced { display: none; }
    .input_replaced:checked + .checkbox {
      background-color: #0c67f6;
      border-color: #0c67f6;
      position: relative;
    }
    .input_replaced:checked + .checkbox::after {
      content: '✓';
      color: white;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- ====== FORMULAIRE BREVO ====== -->
    <div class="sib-form" style="text-align:center;background-color:#c8dbf6;">
      <div id="sib-form-container" class="sib-form-container">
        <div id="error-message" class="sib-form-message-panel" style="font-size:16px;text-align:left;font-family:Helvetica,sans-serif;color:#661d1d;background-color:#ffeded;border-radius:3px;border-color:#ff4949;max-width:540px;display:none;padding:10px;margin-bottom:10px"></div>
        
        <div id="success-message" class="sib-form-message-panel" style="font-size:16px;text-align:left;font-family:Helvetica,sans-serif;color:#085229;background-color:#e7faf0;border-radius:3px;border-color:#13ce66;max-width:540px;display:none;padding:10px;margin-bottom:10px"></div>

        <div id="sib-container" class="sib-container--large sib-container--vertical" style="text-align:center;background-color:rgba(255,255,255,1);max-width:540px;border-radius:3px;border-width:1px;border-color:#C0CCD9;border-style:solid;direction:ltr">
          <form id="sib-form" method="POST"
                action="https://9993d118.sibforms.com/serve/MUIFAIKOe5Sudb3ZQDKEZ40Z2g2hD0i5x83Jq37H2GPwMMxL-LQ7leF103fyMp2UJyw6OYdM0mZwq7bTEw2jnCIGOW_WhM2oChmuAxfT5e11foIE7TKZg2XoYbboS3em2DyNairtv7b_hixE2vTBFMMXnd6QVafE-ZP8cmHMjKDfUgH7MgkVDS2tFe8U5mFpgeO18UAIBBOhAo_q"
                target="sibframe" data-type="subscription">

            <div style="padding:8px 0">
              <div class="sib-form-block" style="font-size:34px;text-align:left;font-weight:700;font-family:&quot;Trebuchet MS&quot;,sans-serif;color:#0c67f6;background-color:transparent">
                <p>DATA LIGUE 1 (Gratuit)</p>
              </div>
            </div>

            <div style="padding:8px 0">
              <div class="sib-form-block" style="font-size:16px;text-align:left;font-weight:700;font-family:Helvetica,sans-serif;color:#3C4858;background-color:transparent">
                <div class="sib-text-form-block">
                  <p>Des stats claires et exclusives, livrées après chaque match de votre club.</p>
                </div>
              </div>
            </div>

            <!-- EMAIL -->
            <div style="padding:8px 0">
              <div class="sib-input sib-form-block">
                <div class="form__entry entry_block">
                  <div class="form__label-row">
                    <label class="entry__label" style="font-weight:700;text-align:left;font-size:16px;color:#3c4858" for="EMAIL" data-required="*">ENTREZ VOTRE EMAIL</label>
                    <div class="entry__field">
                      <input class="input" type="text" id="EMAIL" name="EMAIL" autocomplete="off" placeholder="votre@email.com" data-required="true" required style="padding:8px;width:100%;border:1px solid #c0ccda;border-radius:3px;font-size:16px" />
                    </div>
                  </div>
                  <label class="entry__error entry__error--primary" style="font-size:16px;text-align:left;font-family:Helvetica,sans-serif;color:#661d1d;background-color:#ffeded;border-radius:3px;border-color:#ff4949;"></label>
                </div>
              </div>
            </div>

            <!-- CLUBS avec Voir Plus -->
            <div style="padding:8px 0">
              <div class="sib-checkbox-group sib-form-block" data-required="true">
                <div class="form__entry entry_mcq">
                  <div class="form__label-row">
                    <label class="entry__label" style="font-weight:700;text-align:left;font-size:16px;color:#3c4858" data-required="*">
                      Choisissez votre CLUB et recevez l'analyse DATA après chaque journée (plusieurs choix possibles)
                    </label>
                    
                    <div style="margin-top:10px">
                      <!-- Clubs visibles (les plus populaires) -->
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="PSG" value="3" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>PSG</span>
                        </label>
                      </div>
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Marseille" value="24" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>Marseille</span>
                        </label>
                      </div>
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Lyon" value="9" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>Lyon</span>
                        </label>
                      </div>
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Lens" value="13" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>Lens</span>
                        </label>
                      </div>
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Lille" value="11" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>Lille</span>
                        </label>
                      </div>
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Monaco" value="10" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>Monaco</span>
                        </label>
                      </div>
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Nice" value="12" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>Nice</span>
                        </label>
                      </div>
                      <div class="entry__choice">
                        <label class="checkbox__label">
                          <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Rennes" value="14" data-required="true" />
                          <span class="checkbox checkbox_tick_positive"></span><span>Rennes</span>
                        </label>
                      </div>

                      <!-- Bouton Voir plus -->
                      <button id="toggle-more" type="button" class="see-more-btn" aria-expanded="false" aria-controls="more-clubs">Voir plus de clubs</button>

                      <!-- Clubs cachés -->
                      <div id="more-clubs" hidden>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Nantes" value="15" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Nantes</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Strasbourg" value="17" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Strasbourg</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Toulouse" value="16" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Toulouse</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Brest" value="18" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Brest</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Le Havre" value="4" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Le Havre</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Auxerre" value="21" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Auxerre</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Angers" value="23" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Angers</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Lorient" value="20" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Lorient</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Metz" value="19" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Metz</span>
                          </label>
                        </div>
                        <div class="entry__choice">
                          <label class="checkbox__label">
                            <input type="checkbox" class="input_replaced" name="lists_25[]" data-value="Paris FC" value="22" data-required="true" />
                            <span class="checkbox checkbox_tick_positive"></span><span>Paris FC</span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <label class="entry__error entry__error--primary" style="font-size:16px;text-align:left;font-family:Helvetica,sans-serif;color:#661d1d;background-color:#ffeded;border-radius:3px;border-color:#ff4949;"></label>
                </div>
              </div>
            </div>

            <!-- RGPD OBLIGATOIRE -->
            <div style="padding:8px 0">
              <div class="sib-optin sib-form-block" data-required="true">
                <div class="form__entry entry_mcq">
                  <div class="form__label-row">
                    <div class="entry__choice" style="">
                      <label class="checkbox__label">
                        <input type="checkbox" class="input_replaced" value="1" id="OPT_IN" name="OPT_IN" required />
                        <span class="checkbox checkbox_tick_positive"></span>
                        <span style="font-size:16px;text-align:left;font-weight:600;font-family:Helvetica,sans-serif;color:#3C4858;background-color:transparent;">
                          J'accepte de recevoir vos emails. Désabonnement en 1 clic. <a href="https://www.brevo.com/fr/legal/privacypolicy/" target="_blank">Politique de confidentialité de Brevo</a> 🔒
                        </span>
                      </label>
                    </div>
                  </div>
                  <label class="entry__error entry__error--primary" style="font-size:16px;text-align:left;font-family:Helvetica,sans-serif;color:#661d1d;background-color:#ffeded;border-radius:3px;border-color:#ff4949;"></label>
                </div>
              </div>
            </div>

            <!-- CTA avec protection anti-overlay -->
            <div style="padding:8px 0">
              <div class="sib-form-block" style="text-align:left">
                <button class="sib-form-block__button sib-form-block__button-with-loader" 
                        style="font-size:25px;text-align:center;font-weight:700;font-family:Helvetica,sans-serif;color:#FFFFFF;background-color:#0c67f6;border-radius:3px;border-width:0px;width:100%;cursor:pointer"
                        form="sib-form" 
                        type="submit"
                        id="cta-submit">
                  RECEVOIR MON ANALYSE
                </button>
              </div>
            </div>

            <!-- reCAPTCHA v3 invisible -->
            <div style="padding:8px 0">
              <div class="g-recaptcha-v3" data-sitekey="6LcN-9QrAAAAADuu2DsGlnzLZaAHqBje2LUJnzJC" style="display:none"></div>
            </div>

            <!-- Champs techniques -->
            <input type="text" name="email_address_check" value="" class="input--hidden">
            <input type="hidden" name="locale" value="fr">
            <!-- UTM cachés -->
            <input type="hidden" name="utm_source" id="utm_source">
            <input type="hidden" name="utm_medium" id="utm_medium">
            <input type="hidden" name="utm_campaign" id="utm_campaign">
            <input type="hidden" name="utm_content" id="utm_content">
          </form>
        </div>
      </div>
    </div>
    <!-- ====== / FORMULAIRE ====== -->
  </div>

  <!-- iFrame cible pour la soumission (évite CORS) -->
  <iframe id="sibframe" name="sibframe"></iframe>

  <!-- Textes Brevo (messages) -->
  <script>
    window.REQUIRED_CODE_ERROR_MESSAGE='Veuillez choisir un code pays';
    window.LOCALE='fr';
    window.EMAIL_INVALID_MESSAGE = window.SMS_INVALID_MESSAGE =
      "Les informations que vous avez fournies ne sont pas valides. Veuillez vérifier le format du champ et réessayer.";
    window.REQUIRED_ERROR_MESSAGE = "Vous devez renseigner ce champ.";
    window.GENERIC_INVALID_MESSAGE = window.EMAIL_INVALID_MESSAGE;
    window.REQUIRED_MULTISELECT_MESSAGE = 'Veuillez choisir au moins une option';
    window.translation = { 
      common: { 
        selectedList: '{quantity} liste sélectionnée', 
        selectedLists: '{quantity} listes sélectionnées', 
        selectedOption: '{quantity} sélectionné', 
        selectedOptions: '{quantity} sélectionnés' 
      } 
    };
    var AUTOHIDE = Boolean(0);
  </script>

  <!-- Script principal avec UTM + Voir plus + Soumission -->
  <script>
    function readCookie(name){
      return document.cookie.split('; ').reduce((acc, c)=>{
        const [k,v]=c.split('=');
        if(k===name) acc=decodeURIComponent(v||'');
        return acc;
      }, '');
    }
    
    function getParam(name){
      const u = new URL(location.href);
      return u.searchParams.get(name) || readCookie(name) || '';
    }
    
    function setHidden(id, val){ 
      const el=document.getElementById(id); 
      if(el) el.value = val || ''; 
    }
    
    function okEmail(v){ 
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test((v||'').trim()); 
    }
    
    function oneClub(form){ 
      return Array.from(form.querySelectorAll('input[name="lists_25[]"]')).some(c=>c.checked); 
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      // UTM -> hidden
      const utm = {
        source:   getParam('utm_source'),
        medium:   getParam('utm_medium'),
        campaign: getParam('utm_campaign') || 'signup_l1_2025',
        content:  getParam('utm_content')  || 'bio'
      };
      setHidden('utm_source',  utm.source);
      setHidden('utm_medium',  utm.medium);
      setHidden('utm_campaign',utm.campaign);
      setHidden('utm_content', utm.content);

      // Bouton Voir plus
      const btn  = document.getElementById('toggle-more');
      const more = document.getElementById('more-clubs');
      if (btn && more) {
        btn.addEventListener('click', () => {
          more.removeAttribute('hidden');
          btn.remove();
        });
      }

      // Soumission via iFrame (pas de CORS)
      const form    = document.getElementById('sib-form');
      const success = document.getElementById('success-message');
      const error   = document.getElementById('error-message');
      const emailEl = document.getElementById('EMAIL');
      const optIn   = document.getElementById('OPT_IN');
      const frame   = document.getElementById('sibframe');

      if (!form || !frame) return;

      // Armer/désarmer la détection de "retour" iFrame
      let armed = false;

      frame.addEventListener('load', ()=>{
        // Ignore le premier load (page blanche initiale)
        if (!armed) return;
        // On considère la soumission réussie
        if (success){
          success.style.display = 'block';
          success.textContent = 'Inscription confirmée !';
        }
        try{
          gtag('event','generate_lead',{
            form_name:'Brevo - Inscription',
            origin: utm.source || '(direct)',
            medium: utm.medium || '(none)',
            variant: utm.content || 'bio'
          });
        }catch(e){}
        const next = new URL('/merci-inscription/', location.origin);
        next.searchParams.set('utm_source', utm.source || '');
        next.searchParams.set('utm_medium', utm.medium || '');
        next.searchParams.set('utm_campaign', utm.campaign || '');
        next.searchParams.set('utm_content', utm.content || '');
        setTimeout(()=>location.href = next.toString(), 400);
        armed = false; // reset
      });

      form.addEventListener('submit', (e)=>{
        // Validation minimale côté client
        const email = emailEl ? emailEl.value : '';
        
        // Vérifications
        if (!okEmail(email)) {
          e.preventDefault();
          if (error){
            error.style.display = 'block';
            error.textContent = 'Veuillez saisir un email valide.';
          }
          if (emailEl) emailEl.focus();
          return;
        }
        
        if (!oneClub(form)) {
          e.preventDefault();
          if (error){
            error.style.display = 'block';
            error.textContent = 'Veuillez choisir au moins un club.';
          }
          return;
        }
        
        if (optIn && !optIn.checked) {
          e.preventDefault();
          if (error){
            error.style.display = 'block';
            error.textContent = 'Veuillez accepter de recevoir nos emails.';
          }
          return;
        }
        
        // Nettoie les panneaux et arme le handler iFrame
        if (error){ error.style.display='none'; error.textContent=''; }
        if (success){ success.style.display='none'; success.textContent=''; }
        armed = true; // le prochain load de l'iFrame correspondra à la réponse Brevo
      });
    });
  </script>

  <!-- Scripts Brevo - Script principal commenté pour éviter les conflits -->
  <!-- <script defer src="https://sibforms.com/forms/end-form/build/main.js"></script> -->
  
  <!-- reCAPTCHA v3 -->
  <script src="https://www.google.com/recaptcha/api.js?render=6LcN-9QrAAAAADuu2DsGlnzLZaAHqBje2LUJnzJC&hl=fr" async defer></script>
</body>
</html>
